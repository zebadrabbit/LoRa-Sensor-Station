<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Runtime Configuration</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/bootstrap-custom.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>
    <div class="container-fluid" style="max-width: 1200px;">
        <div class="header">
            <h1>âš™ï¸ Runtime Configuration</h1>
            <p>Configure sensor settings remotely via LoRa</p>
        </div>
        
        <!-- Navigation Menu -->
        <div class="nav-menu">
            <a href="/" class="nav-btn">ğŸ“Š Dashboard</a>
            <a href="/alerts" class="nav-btn">ğŸ”” Alerts</a>
            <a href="/mqtt" class="nav-btn">ğŸ“¡ MQTT</a>
            <a href="/time" class="nav-btn active">â±ï¸ Time</a>
            <a href="/security" class="nav-btn">ğŸ”’ Security</a>
            <a href="/lora-settings" class="nav-btn">ğŸ“» LoRa Settings</a>
        </div>
        
        <div class="card">
            <div id="sensorInfo">
                <strong style="font-size: 16px;">ğŸ“¡ Configuring Sensor:</strong><br>
                <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px;">
                    <div><strong>Location:</strong> <span id="currentLocation">-</span></div>
                    <div><strong>ID:</strong> <span id="currentSensorId">-</span></div>
                    <div><strong>Last Seen:</strong> <span id="lastSeen">-</span></div>
                    <div><strong>Battery:</strong> <span id="battery">-</span>%</div>
                </div>
            </div>
        </div>

        <div class="card">
            <div class="card-title">ğŸ“ Sensor Location</div>
            <form id="locationForm">
                <div class="form-group">
                    <label for="locationInput">Sensor Name/Location</label>
                    <input type="text" id="locationInput" placeholder="e.g., Living Room, Garage, Freezer" maxlength="31" required>
                    <small>Maximum 31 characters</small>
                </div>
                <button type="submit" class="btn" id="updateLocationBtn">ğŸ’¾ Update Location</button>
            </form>
        </div>
        
        <div class="card">
            <div class="card-title">â±ï¸ Transmission Interval</div>
            <form id="intervalForm">
                <div class="form-group">
                    <label for="intervalInput">Interval (seconds)</label>
                    <input type="number" id="intervalInput" min="10" max="3600" value="30" required>
                    <small>Range: 10 seconds to 1 hour (3600 seconds)</small>
                </div>
                <div style="margin-top: 10px;">
                    <strong>Quick Presets:</strong><br>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(10)">10s</button>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(30)">30s</button>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(60)">1 min</button>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(300)">5 min</button>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(900)">15 min</button>
                    <button type="button" class="btn btn-secondary preset-btn" onclick="setInterval(1800)">30 min</button>
                </div>
                <button type="submit" class="btn" id="updateIntervalBtn" style="margin-top: 15px;">ğŸ’¾ Update Interval</button>
            </form>
        </div>
        
        <div class="card">
            <div class="card-title">ğŸ”„ Sensor Actions</div>
            <p>Send commands to the selected sensor</p>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                <button class="btn btn-secondary action-btn" id="restartBtn" onclick="restartSensor()">ğŸ”„ Restart Sensor</button>
                <button class="btn btn-secondary action-btn" id="pingBtn" onclick="pingSensor()">ğŸ“¡ Request Immediate Ping</button>
            </div>
        </div>
        
        <div class="card">
            <div class="card-title">â„¹ï¸ Information</div>
            <p><strong>How it works:</strong> Commands are sent via LoRa to the sensor. The sensor will acknowledge the command in its next transmission.</p>
            <p><strong>Response time:</strong> Sensors with long intervals will temporarily switch to 10-second intervals for 60 seconds after receiving a command, allowing quick responses.</p>
            <p><strong>No WiFi required:</strong> Sensors don't need WiFi connectivity. All configuration happens over LoRa radio.</p>
        </div>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const script = document.createElement('script');
            script.src = '/runtime-config.js';
            script.defer = true;
            document.body.appendChild(script);
        });
    </script>
</body>
</html>
